<!DOCTYPE html>
<html lang="es" class="h-full">
<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Carta Nomo · Sarria</title>
  <link rel="manifest" href="manifest.json">
  <meta name="theme-color" content="#ffffff" />
  <meta name="apple-mobile-web-app-capable" content="yes" />
  <meta name="apple-mobile-web-app-status-bar-style" content="default" />

  <link rel="stylesheet" href="styles.css" />
</head>
<body>
  <div class="page">
    <header class="glass appbar" role="banner">
      <div class="title">
        <svg width="28" height="28" viewBox="0 0 24 24" fill="none" aria-hidden="true">
          <path d="M12 2c-2.5 0-4.5 2-4.5 4.5S9.5 11 12 11s4.5-2 4.5-4.5S14.5 2 12 2Zm0 10c-4.4 0-8 2.2-8 5v1.5c0 .8.7 1.5 1.5 1.5h13c.8 0 1.5-.7 1.5-1.5V17c0-2.8-3.6-5-8-5Z" fill="currentColor" opacity=".9"/>
        </svg>
        <div>
          <h1>Carta Nomo · Sarria</h1>
          <p class="subtitle">Toca un número para ver y escuchar. Azul = libre/no existe en menú.</p>
        </div>
      </div>
      <div class="toolbar" role="toolbar" aria-label="Acciones">
        <span id="userInfo" class="subtitle" aria-live="polite">Sesión: invitado</span>
        <button id="loginBtn" class="btn">Iniciar sesión</button>
        <button id="logoutBtn" class="btn hidden">Salir</button>
        <button id="editarBtn" class="btn primary hidden">Editar</button>
        <button id="borrarBtn" class="btn danger hidden">Borrar</button>
        <!-- Botones admin -->
        <button id="exportBtn" class="btn hidden">Exportar JSON</button>
        <button id="exportCsvBtn" class="btn hidden">Exportar CSV</button>
        <button id="importBtn" class="btn hidden">Importar</button>
      </div>
    </header>

    <section class="glass card" aria-labelledby="gridLabel">
      <h2 id="gridLabel" class="subtitle" style="position:absolute;left:-9999px">Selección de números</h2>
      <div id="grid" class="grid" role="grid" aria-describedby="gridHelp"></div>
      <p id="gridHelp" class="subtitle" style="padding: 6px 6px 0">Consejo: usa ← → para moverte, Enter para escuchar.</p>
      <div id="output" aria-live="polite" aria-atomic="true"></div>
    </section>
  </div>

  <!-- Modal inicio de sesión -->
  <div id="loginBackdrop" class="backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="glass sheet" role="document">
      <header><h2>Iniciar sesión</h2></header>
      <div class="body">
        <div class="row">
          <label for="loginEmail">Correo</label>
          <input type="email" id="loginEmail" required aria-invalid="false" />
          <div id="loginEmailError" class="error" aria-live="polite"></div>
        </div>
        <div class="row">
          <label for="loginPass">Contraseña</label>
          <input type="password" id="loginPass" required aria-invalid="false" />
          <div id="loginPassError" class="error" aria-live="polite"></div>
        </div>
      </div>
      <div class="actions">
        <button id="loginCancel" class="btn">Cancelar</button>
        <button id="loginSubmit" class="btn primary">Entrar</button>
      </div>
    </div>
  </div>

  <!-- Sheet edición -->
  <div id="editBackdrop" class="backdrop" role="dialog" aria-modal="true" aria-hidden="true">
    <div class="glass sheet" role="document">
      <header><h2>Editar número</h2></header>
      <div class="body">
        <div class="row"><label for="numSel">Número</label><input type="number" id="numSel" min="1" max="100" inputmode="numeric" /></div>
        <div class="row"><label for="palabra">Palabra</label><input type="text" id="palabra" placeholder="Escribe la palabra…" /></div>
        <div class="row"><label for="descripcion">Descripción</label><input type="text" id="descripcion" placeholder="Añade una descripción…" /></div>
        <div class="row"><label for="imagen">Imagen (opcional)</label><input type="file" id="imagen" accept="image/*" /></div>
      </div>
      <div class="actions">
        <button id="cancelarBtn" class="btn">Cancelar</button>
        <button id="guardarBtn" class="btn primary">Guardar</button>
      </div>
    </div>
  </div>

  <!-- Popup de vista (detalle número) -->
  <div id="viewBackdrop" class="backdrop" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="viewTitle" aria-describedby="viewDesc">
    <div class="glass sheet" role="document">
      <header>
        <h2 id="viewTitle">—</h2>
      </header>

      <div class="body">
        <img id="viewImage" class="preview" alt="" />
        <p id="viewDesc" class="subtitle popup-desc"></p>
      </div>

      <div class="actions popup-actions">
        <button id="viewCloseBtn" class="btn">Cerrar</button>
        <!-- Zona admin: visible solo con sesión -->
        <div id="viewAdminActions" class="admin-only popup-admin hidden">
          <button id="viewEditBtn" class="btn primary">Editar</button>
          <button id="viewDeleteBtn" class="btn danger">Borrar</button>
        </div>
      </div>
    </div>
  </div>

  <script type="module" src="app.js"></script>
</body>
</html>


